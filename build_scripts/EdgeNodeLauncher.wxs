<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" 
           Name="EdgeNodeLauncher" 
           Language="1033" 
           Version="1.0.0" 
           Manufacturer="Your Company" 
           UpgradeCode="1A2B3C4D-5E6F-7G8H-9I0J-1K2L3M4N5O6P">
    
    <Package InstallerVersion="200" 
             Compressed="yes" 
             InstallScope="perMachine" />
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of EdgeNodeLauncher is already installed." />
    <MediaTemplate EmbedCab="yes" />
    
    <Feature Id="ProductFeature" Title="EdgeNodeLauncher" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcuts"/>
    </Feature>
    
    <!-- UI Configuration -->
    <UIRef Id="WixUI_InstallDir" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />
    
    <!-- Directory Structure -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="EdgeNodeLauncher">
          <Component Id="MainExecutable" Guid="*">
            <File Id="ExeFile" 
                  Source="$(var.SourcePath)" 
                  KeyPath="yes" />
          </Component>
        </Directory>
      </Directory>
      
      <!-- Start Menu Shortcuts -->
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="EdgeNodeLauncher">
          <Component Id="ApplicationShortcuts" Guid="*">
            <Shortcut Id="ApplicationStartMenuShortcut" 
                      Name="EdgeNodeLauncher" 
                      Description="Launch EdgeNodeLauncher"
                      Target="[INSTALLFOLDER]EdgeNodeLauncher.exe"
                      WorkingDirectory="INSTALLFOLDER"/>
            <RemoveFolder Id="RemoveApplicationProgramsFolder" 
                         On="uninstall"/>
            <RegistryValue Root="HKCU" 
                          Key="Software\EdgeNodeLauncher" 
                          Name="installed" 
                          Type="integer" 
                          Value="1" 
                          KeyPath="yes"/>
          </Component>
        </Directory>
      </Directory>
      
      <!-- Desktop Shortcut -->
      <Directory Id="DesktopFolder" Name="Desktop">
        <Component Id="ApplicationDesktopShortcut" Guid="*">
          <Shortcut Id="DesktopShortcut"
                    Name="EdgeNodeLauncher"
                    Description="Launch EdgeNodeLauncher"
                    Target="[INSTALLFOLDER]EdgeNodeLauncher.exe"
                    WorkingDirectory="INSTALLFOLDER"/>
          <RegistryValue Root="HKCU"
                        Key="Software\EdgeNodeLauncher"
                        Name="installed"
                        Type="integer"
                        Value="1"
                        KeyPath="yes"/>
        </Component>
      </Directory>
    </Directory>
    
    <!-- Components to install -->
    <ComponentGroup Id="ProductComponents">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="ApplicationDesktopShortcut" />
    </ComponentGroup>
    
  </Product>
</Wix> 